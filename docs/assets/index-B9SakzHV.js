(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const nn=!1,rn=(t,e)=>t===e,X=Symbol("solid-proxy"),sn=typeof Proxy=="function",We=Symbol("solid-track"),Le={equals:rn};let At=Ct;const Q=1,ke=2,Pt={owned:null,cleanups:null,context:null,owner:null};var L=null;let Ke=null,ln=null,j=null,N=null,H=null,Ne=0;function de(t,e){const n=j,r=L,s=t.length===0,i=e===void 0?r:e,o=s?Pt:{owned:null,cleanups:null,context:i?i.context:null,owner:i},l=s?t:()=>t(()=>U(()=>ye(o)));L=o,j=null;try{return Z(l,!0)}finally{j=n,L=r}}function $(t,e){e=e?Object.assign({},Le,e):Le;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},r=s=>(typeof s=="function"&&(s=s(n.value)),kt(n,s));return[Lt.bind(n),r]}function k(t,e,n){const r=st(t,e,!1,Q);_e(r)}function ue(t,e,n){At=fn;const r=st(t,e,!1,Q);r.user=!0,H?H.push(r):_e(r)}function E(t,e,n){n=n?Object.assign({},Le,n):Le;const r=st(t,e,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,_e(r),Lt.bind(r)}function ge(t){return Z(t,!1)}function U(t){if(j===null)return t();const e=j;j=null;try{return t()}finally{j=e}}function nt(t,e,n){const r=Array.isArray(t);let s,i=n&&n.defer;return o=>{let l;if(r){l=Array(t.length);for(let c=0;c<t.length;c++)l[c]=t[c]()}else l=t();if(i)return i=!1,o;const a=U(()=>e(l,s,o));return s=l,a}}function xt(t){ue(()=>U(t))}function we(t){return L===null||(L.cleanups===null?L.cleanups=[t]:L.cleanups.push(t)),t}function Ge(){return j}function $t(){return L}function St(t,e){const n=L,r=j;L=t,j=null;try{return Z(e,!0)}catch(s){it(s)}finally{L=n,j=r}}function on(t){const e=j,n=L;return Promise.resolve().then(()=>{j=e,L=n;let r;return Z(t,!1),j=L=null,r?r.done:void 0})}function Et(t,e){const n=Symbol("context");return{id:n,Provider:dn(n),defaultValue:t}}function an(t){let e;return L&&L.context&&(e=L.context[t.id])!==void 0?e:t.defaultValue}function rt(t){const e=E(t),n=E(()=>He(e()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function Lt(){if(this.sources&&this.state)if(this.state===Q)_e(this);else{const t=N;N=null,Z(()=>je(this),!1),N=t}if(j){const t=this.observers?this.observers.length:0;j.sources?(j.sources.push(this),j.sourceSlots.push(t)):(j.sources=[this],j.sourceSlots=[t]),this.observers?(this.observers.push(j),this.observerSlots.push(j.sources.length-1)):(this.observers=[j],this.observerSlots=[j.sources.length-1])}return this.value}function kt(t,e,n){let r=t.value;return(!t.comparator||!t.comparator(r,e))&&(t.value=e,t.observers&&t.observers.length&&Z(()=>{for(let s=0;s<t.observers.length;s+=1){const i=t.observers[s],o=Ke&&Ke.running;o&&Ke.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?N.push(i):H.push(i),i.observers&&jt(i)),o||(i.state=Q)}if(N.length>1e6)throw N=[],new Error},!1)),e}function _e(t){if(!t.fn)return;ye(t);const e=Ne;cn(t,t.value,e)}function cn(t,e,n){let r;const s=L,i=j;j=L=t;try{r=t.fn(e)}catch(o){return t.pure&&(t.state=Q,t.owned&&t.owned.forEach(ye),t.owned=null),t.updatedAt=n+1,it(o)}finally{j=i,L=s}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?kt(t,r):t.value=r,t.updatedAt=n)}function st(t,e,n,r=Q,s){const i={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:L,context:L?L.context:null,pure:n};return L===null||L!==Pt&&(L.owned?L.owned.push(i):L.owned=[i]),i}function Ce(t){if(t.state===0)return;if(t.state===ke)return je(t);if(t.suspense&&U(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Ne);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===Q)_e(t);else if(t.state===ke){const r=N;N=null,Z(()=>je(t,e[0]),!1),N=r}}function Z(t,e){if(N)return t();let n=!1;e||(N=[]),H?n=!0:H=[],Ne++;try{const r=t();return un(n),r}catch(r){n||(H=null),N=null,it(r)}}function un(t){if(N&&(Ct(N),N=null),t)return;const e=H;H=null,e.length&&Z(()=>At(e),!1)}function Ct(t){for(let e=0;e<t.length;e++)Ce(t[e])}function fn(t){let e,n=0;for(e=0;e<t.length;e++){const r=t[e];r.user?t[n++]=r:Ce(r)}for(e=0;e<n;e++)Ce(t[e])}function je(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const r=t.sources[n];if(r.sources){const s=r.state;s===Q?r!==e&&(!r.updatedAt||r.updatedAt<Ne)&&Ce(r):s===ke&&je(r,e)}}}function jt(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=ke,n.pure?N.push(n):H.push(n),n.observers&&jt(n))}}function ye(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),r=t.sourceSlots.pop(),s=n.observers;if(s&&s.length){const i=s.pop(),o=n.observerSlots.pop();r<s.length&&(i.sourceSlots[o]=r,s[r]=i,n.observerSlots[r]=o)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)ye(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)ye(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function hn(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function it(t,e=L){throw hn(t)}function He(t){if(typeof t=="function"&&!t.length)return He(t());if(Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++){const r=He(t[n]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return e}return t}function dn(t,e){return function(r){let s;return k(()=>s=U(()=>(L.context={...L.context,[t]:r.value},rt(()=>r.children))),void 0),s}}const gn=Symbol("fallback");function ut(t){for(let e=0;e<t.length;e++)t[e]()}function mn(t,e,n={}){let r=[],s=[],i=[],o=0,l=e.length>1?[]:null;return we(()=>ut(i)),()=>{let a=t()||[],c=a.length,u,f;return a[We],U(()=>{let g,p,d,m,v,_,b,y,w;if(c===0)o!==0&&(ut(i),i=[],r=[],s=[],o=0,l&&(l=[])),n.fallback&&(r=[gn],s[0]=de(O=>(i[0]=O,n.fallback())),o=1);else if(o===0){for(s=new Array(c),f=0;f<c;f++)r[f]=a[f],s[f]=de(h);o=c}else{for(d=new Array(c),m=new Array(c),l&&(v=new Array(c)),_=0,b=Math.min(o,c);_<b&&r[_]===a[_];_++);for(b=o-1,y=c-1;b>=_&&y>=_&&r[b]===a[y];b--,y--)d[y]=s[b],m[y]=i[b],l&&(v[y]=l[b]);for(g=new Map,p=new Array(y+1),f=y;f>=_;f--)w=a[f],u=g.get(w),p[f]=u===void 0?-1:u,g.set(w,f);for(u=_;u<=b;u++)w=r[u],f=g.get(w),f!==void 0&&f!==-1?(d[f]=s[u],m[f]=i[u],l&&(v[f]=l[u]),f=p[f],g.set(w,f)):i[u]();for(f=_;f<c;f++)f in d?(s[f]=d[f],i[f]=m[f],l&&(l[f]=v[f],l[f](f))):s[f]=de(h);s=s.slice(0,o=c),r=a.slice(0)}return s});function h(g){if(i[f]=g,l){const[p,d]=$(f);return l[f]=d,e(a[f],p)}return e(a[f])}}}function A(t,e){return U(()=>t(e||{}))}function xe(){return!0}const yn={get(t,e,n){return e===X?n:t.get(e)},has(t,e){return e===X?!0:t.has(e)},set:xe,deleteProperty:xe,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:xe,deleteProperty:xe}},ownKeys(t){return t.keys()}};function Ue(t){return(t=typeof t=="function"?t():t)?t:{}}function pn(){for(let t=0,e=this.length;t<e;++t){const n=this[t]();if(n!==void 0)return n}}function Ot(...t){let e=!1;for(let o=0;o<t.length;o++){const l=t[o];e=e||!!l&&X in l,t[o]=typeof l=="function"?(e=!0,E(l)):l}if(sn&&e)return new Proxy({get(o){for(let l=t.length-1;l>=0;l--){const a=Ue(t[l])[o];if(a!==void 0)return a}},has(o){for(let l=t.length-1;l>=0;l--)if(o in Ue(t[l]))return!0;return!1},keys(){const o=[];for(let l=0;l<t.length;l++)o.push(...Object.keys(Ue(t[l])));return[...new Set(o)]}},yn);const n={},r=Object.create(null);for(let o=t.length-1;o>=0;o--){const l=t[o];if(!l)continue;const a=Object.getOwnPropertyNames(l);for(let c=a.length-1;c>=0;c--){const u=a[c];if(u==="__proto__"||u==="constructor")continue;const f=Object.getOwnPropertyDescriptor(l,u);if(!r[u])r[u]=f.get?{enumerable:!0,configurable:!0,get:pn.bind(n[u]=[f.get.bind(l)])}:f.value!==void 0?f:void 0;else{const h=n[u];h&&(f.get?h.push(f.get.bind(l)):f.value!==void 0&&h.push(()=>f.value))}}}const s={},i=Object.keys(r);for(let o=i.length-1;o>=0;o--){const l=i[o],a=r[l];a&&a.get?Object.defineProperty(s,l,a):s[l]=a?a.value:void 0}return s}const bn=t=>`Stale read from <${t}>.`;function J(t){const e="fallback"in t&&{fallback:()=>t.fallback};return E(mn(()=>t.each,t.children,e||void 0))}function I(t){const e=t.keyed,n=E(()=>t.when,void 0,void 0),r=e?n:E(n,void 0,{equals:(s,i)=>!s==!i});return E(()=>{const s=r();if(s){const i=t.children;return typeof i=="function"&&i.length>0?U(()=>i(e?s:()=>{if(!U(r))throw bn("Show");return n()})):i}return t.fallback},void 0,void 0)}const vn=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],wn=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...vn]),_n=new Set(["innerHTML","textContent","innerText","children"]),An=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Pn=Object.assign(Object.create(null),{class:"className",formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function xn(t,e){const n=Pn[t];return typeof n=="object"?n[e]?n.$:void 0:n}const $n=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]);function Sn(t,e,n){let r=n.length,s=e.length,i=r,o=0,l=0,a=e[s-1].nextSibling,c=null;for(;o<s||l<i;){if(e[o]===n[l]){o++,l++;continue}for(;e[s-1]===n[i-1];)s--,i--;if(s===o){const u=i<r?l?n[l-1].nextSibling:n[i-l]:a;for(;l<i;)t.insertBefore(n[l++],u)}else if(i===l)for(;o<s;)(!c||!c.has(e[o]))&&e[o].remove(),o++;else if(e[o]===n[i-1]&&n[l]===e[s-1]){const u=e[--s].nextSibling;t.insertBefore(n[l++],e[o++].nextSibling),t.insertBefore(n[--i],u),e[s]=n[i]}else{if(!c){c=new Map;let f=l;for(;f<i;)c.set(n[f],f++)}const u=c.get(e[o]);if(u!=null)if(l<u&&u<i){let f=o,h=1,g;for(;++f<s&&f<i&&!((g=c.get(e[f]))==null||g!==u+h);)h++;if(h>u-l){const p=e[o];for(;l<u;)t.insertBefore(n[l++],p)}else t.replaceChild(n[l++],e[o++])}else o++;else e[o++].remove()}}}const ft="_$DX_DELEGATE";function En(t,e,n,r={}){let s;return de(i=>{s=i,e===document?t():x(e,t(),e.firstChild?null:void 0,n)},r.owner),()=>{s(),e.textContent=""}}function B(t,e,n,r){let s;const i=()=>{const l=document.createElement("template");return l.innerHTML=t,l.content.firstChild},o=()=>(s||(s=i())).cloneNode(!0);return o.cloneNode=o,o}function ee(t,e=window.document){const n=e[ft]||(e[ft]=new Set);for(let r=0,s=t.length;r<s;r++){const i=t[r];n.has(i)||(n.add(i),e.addEventListener(i,Bn))}}function pe(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function Ln(t,e,n){n?t.setAttribute(e,""):t.removeAttribute(e)}function P(t,e){e==null?t.removeAttribute("class"):t.className=e}function kn(t,e,n,r){if(r)Array.isArray(n)?(t[`$$${e}`]=n[0],t[`$$${e}Data`]=n[1]):t[`$$${e}`]=n;else if(Array.isArray(n)){const s=n[0];t.addEventListener(e,n[0]=i=>s.call(t,n[1],i))}else t.addEventListener(e,n,typeof n!="function"&&n)}function Ae(t,e,n={}){const r=Object.keys(e||{}),s=Object.keys(n);let i,o;for(i=0,o=s.length;i<o;i++){const l=s[i];!l||l==="undefined"||e[l]||(ht(t,l,!1),delete n[l])}for(i=0,o=r.length;i<o;i++){const l=r[i],a=!!e[l];!l||l==="undefined"||n[l]===a||!a||(ht(t,l,!0),n[l]=a)}return n}function Cn(t,e,n){if(!e)return n?pe(t,"style"):e;const r=t.style;if(typeof e=="string")return r.cssText=e;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),e||(e={});let s,i;for(i in n)e[i]==null&&r.removeProperty(i),delete n[i];for(i in e)s=e[i],s!==n[i]&&(r.setProperty(i,s),n[i]=s);return n}function jn(t,e={},n,r){const s={};return k(()=>s.children=be(t,e.children,s.children)),k(()=>typeof e.ref=="function"&&lt(e.ref,t)),k(()=>On(t,e,n,!0,s,!0)),s}function lt(t,e,n){return U(()=>t(e,n))}function x(t,e,n,r){if(n!==void 0&&!r&&(r=[]),typeof e!="function")return be(t,e,r,n);k(s=>be(t,e(),s,n),r)}function On(t,e,n,r,s={},i=!1){e||(e={});for(const o in s)if(!(o in e)){if(o==="children")continue;s[o]=dt(t,o,null,s[o],n,i,e)}for(const o in e){if(o==="children")continue;const l=e[o];s[o]=dt(t,o,l,s[o],n,i,e)}}function Tn(t){return t.toLowerCase().replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function ht(t,e,n){const r=e.trim().split(/\s+/);for(let s=0,i=r.length;s<i;s++)t.classList.toggle(r[s],n)}function dt(t,e,n,r,s,i,o){let l,a,c,u,f;if(e==="style")return Cn(t,n,r);if(e==="classList")return Ae(t,n,r);if(n===r)return r;if(e==="ref")i||n(t);else if(e.slice(0,3)==="on:"){const h=e.slice(3);r&&t.removeEventListener(h,r,typeof r!="function"&&r),n&&t.addEventListener(h,n,typeof n!="function"&&n)}else if(e.slice(0,10)==="oncapture:"){const h=e.slice(10);r&&t.removeEventListener(h,r,!0),n&&t.addEventListener(h,n,!0)}else if(e.slice(0,2)==="on"){const h=e.slice(2).toLowerCase(),g=$n.has(h);if(!g&&r){const p=Array.isArray(r)?r[0]:r;t.removeEventListener(h,p)}(g||n)&&(kn(t,h,n,g),g&&ee([h]))}else e.slice(0,5)==="attr:"?pe(t,e.slice(5),n):e.slice(0,5)==="bool:"?Ln(t,e.slice(5),n):(f=e.slice(0,5)==="prop:")||(c=_n.has(e))||(u=xn(e,t.tagName))||(a=wn.has(e))||(l=t.nodeName.includes("-")||"is"in o)?(f&&(e=e.slice(5),a=!0),e==="class"||e==="className"?P(t,n):l&&!a&&!c?t[Tn(e)]=n:t[u||e]=n):pe(t,An[e]||e,n);return n}function Bn(t){let e=t.target;const n=`$$${t.type}`,r=t.target,s=t.currentTarget,i=a=>Object.defineProperty(t,"target",{configurable:!0,value:a}),o=()=>{const a=e[n];if(a&&!e.disabled){const c=e[`${n}Data`];if(c!==void 0?a.call(e,c,t):a.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&i(e.host),!0},l=()=>{for(;o()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const a=t.composedPath();i(a[0]);for(let c=0;c<a.length-2&&(e=a[c],!!o());c++){if(e._$host){e=e._$host,l();break}if(e.parentNode===s)break}}else l();i(r)}function be(t,e,n,r,s){for(;typeof n=="function";)n=n();if(e===n)return n;const i=typeof e,o=r!==void 0;if(t=o&&n[0]&&n[0].parentNode||t,i==="string"||i==="number"){if(i==="number"&&(e=e.toString(),e===n))return n;if(o){let l=n[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),n=ae(t,n,r,l)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e}else if(e==null||i==="boolean")n=ae(t,n,r);else{if(i==="function")return k(()=>{let l=e();for(;typeof l=="function";)l=l();n=be(t,l,n,r)}),()=>n;if(Array.isArray(e)){const l=[],a=n&&Array.isArray(n);if(Ye(l,e,n,s))return k(()=>n=be(t,l,n,r,!0)),()=>n;if(l.length===0){if(n=ae(t,n,r),o)return n}else a?n.length===0?gt(t,l,r):Sn(t,n,l):(n&&ae(t),gt(t,l));n=l}else if(e.nodeType){if(Array.isArray(n)){if(o)return n=ae(t,n,r,e);ae(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function Ye(t,e,n,r){let s=!1;for(let i=0,o=e.length;i<o;i++){let l=e[i],a=n&&n[t.length],c;if(!(l==null||l===!0||l===!1))if((c=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))s=Ye(t,l,a)||s;else if(c==="function")if(r){for(;typeof l=="function";)l=l();s=Ye(t,Array.isArray(l)?l:[l],Array.isArray(a)?a:[a])||s}else t.push(l),s=!0;else{const u=String(l);a&&a.nodeType===3&&a.data===u?t.push(a):t.push(document.createTextNode(u))}}return s}function gt(t,e,n=null){for(let r=0,s=e.length;r<s;r++)t.insertBefore(e[r],n)}function ae(t,e,n,r){if(n===void 0)return t.textContent="";const s=r||document.createTextNode("");if(e.length){let i=!1;for(let o=e.length-1;o>=0;o--){const l=e[o];if(s!==l){const a=l.parentNode===t;!i&&!o?a?t.replaceChild(s,l):t.insertBefore(s,n):a&&l.remove()}else i=!0}}else t.insertBefore(s,n);return[s]}const Nn=!1;function Tt(){let t=new Set;function e(s){return t.add(s),()=>t.delete(s)}let n=!1;function r(s,i){if(n)return!(n=!1);const o={to:s,options:i,defaultPrevented:!1,preventDefault:()=>o.defaultPrevented=!0};for(const l of t)l.listener({...o,from:l.location,retry:a=>{a&&(n=!0),l.navigate(s,{...i,resolve:!1})}});return!o.defaultPrevented}return{subscribe:e,confirm:r}}let Je;function ot(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Je=window.history.state._depth}ot();function Dn(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function In(t,e){let n=!1;return()=>{const r=Je;ot();const s=r==null?null:Je-r;if(n){n=!1;return}s&&e(s)?(n=!0,window.history.go(-s)):t()}}const Rn=/^(?:[a-z0-9]+:)?\/\//i,Fn=/^\/+|(\/)\/+$/g,Bt="http://sr";function me(t,e=!1){const n=t.replace(Fn,"$1");return n?e||/^[?#]/.test(n)?n:"/"+n:""}function Se(t,e,n){if(Rn.test(e))return;const r=me(t),s=n&&me(n);let i="";return!s||e.startsWith("/")?i=r:s.toLowerCase().indexOf(r.toLowerCase())!==0?i=r+s:i=s,(i||"/")+me(e,!i)}function Vn(t,e){return me(t).replace(/\/*(\*.*)?$/g,"")+me(e)}function Nt(t){const e={};return t.searchParams.forEach((n,r)=>{r in e?Array.isArray(e[r])?e[r].push(n):e[r]=[e[r],n]:e[r]=n}),e}function Kn(t,e,n){const[r,s]=t.split("/*",2),i=r.split("/").filter(Boolean),o=i.length;return l=>{const a=l.split("/").filter(Boolean),c=a.length-o;if(c<0||c>0&&s===void 0&&!e)return null;const u={path:o?"":"/",params:{}},f=h=>n===void 0?void 0:n[h];for(let h=0;h<o;h++){const g=i[h],p=g[0]===":",d=p?a[h]:a[h].toLowerCase(),m=p?g.slice(1):g.toLowerCase();if(p&&Me(d,f(m)))u.params[m]=d;else if(p||!Me(d,m))return null;u.path+=`/${d}`}if(s){const h=c?a.slice(-c).join("/"):"";if(Me(h,f(s)))u.params[s]=h;else return null}return u}}function Me(t,e){const n=r=>r===t;return e===void 0?!0:typeof e=="string"?n(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(n):e instanceof RegExp?e.test(t):!1}function Un(t){const[e,n]=t.pattern.split("/*",2),r=e.split("/").filter(Boolean);return r.reduce((s,i)=>s+(i.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function Dt(t){const e=new Map,n=$t();return new Proxy({},{get(r,s){return e.has(s)||St(n,()=>e.set(s,E(()=>t()[s]))),e.get(s)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function It(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let n=t.slice(0,e.index),r=t.slice(e.index+e[0].length);const s=[n,n+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(r);)s.push(n+=e[1]),r=r.slice(e[0].length);return It(r).reduce((i,o)=>[...i,...s.map(l=>l+o)],[])}const Mn=100,Xn=Et(),Rt=Et();function zn(t,e=""){const{component:n,preload:r,load:s,children:i,info:o}=t,l=!i||Array.isArray(i)&&!i.length,a={key:t,component:n,preload:r||s,info:o};return Ft(t.path).reduce((c,u)=>{for(const f of It(u)){const h=Vn(e,f);let g=l?h:h.split("/*",1)[0];g=g.split("/").map(p=>p.startsWith(":")||p.startsWith("*")?p:encodeURIComponent(p)).join("/"),c.push({...a,originalPath:u,pattern:g,matcher:Kn(g,!l,t.matchFilters)})}return c},[])}function qn(t,e=0){return{routes:t,score:Un(t[t.length-1])*1e4-e,matcher(n){const r=[];for(let s=t.length-1;s>=0;s--){const i=t[s],o=i.matcher(n);if(!o)return null;r.unshift({...o,route:i})}return r}}}function Ft(t){return Array.isArray(t)?t:[t]}function Vt(t,e="",n=[],r=[]){const s=Ft(t);for(let i=0,o=s.length;i<o;i++){const l=s[i];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const a=zn(l,e);for(const c of a){n.push(c);const u=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!u)Vt(l.children,c.pattern,n,r);else{const f=qn([...n],r.length);r.push(f)}n.pop()}}}return n.length?r:r.sort((i,o)=>o.score-i.score)}function Xe(t,e){for(let n=0,r=t.length;n<r;n++){const s=t[n].matcher(e);if(s)return s}return[]}function Wn(t,e,n){const r=new URL(Bt),s=E(u=>{const f=t();try{return new URL(f,r)}catch{return console.error(`Invalid path ${f}`),u}},r,{equals:(u,f)=>u.href===f.href}),i=E(()=>s().pathname),o=E(()=>s().search,!0),l=E(()=>s().hash),a=()=>"",c=nt(o,()=>Nt(s()));return{get pathname(){return i()},get search(){return o()},get hash(){return l()},get state(){return e()},get key(){return a()},query:n?n(c):Dt(c)}}let se;function Gn(){return se}function Hn(t,e,n,r={}){const{signal:[s,i],utils:o={}}=t,l=o.parsePath||(S=>S),a=o.renderPath||(S=>S),c=o.beforeLeave||Tt(),u=Se("",r.base||"");if(u===void 0)throw new Error(`${u} is not a valid base path`);u&&!s().value&&i({value:u,replace:!0,scroll:!1});const[f,h]=$(!1);let g;const p=(S,C)=>{C.value===d()&&C.state===v()||(g===void 0&&h(!0),se=S,g=C,on(()=>{g===C&&(m(g.value),_(g.state),w[1](R=>R.filter(le=>le.pending)))}).finally(()=>{g===C&&ge(()=>{se=void 0,S==="navigate"&&q(g),h(!1),g=void 0})}))},[d,m]=$(s().value),[v,_]=$(s().state),b=Wn(d,v,o.queryWrapper),y=[],w=$([]),O=E(()=>typeof r.transformUrl=="function"?Xe(e(),r.transformUrl(b.pathname)):Xe(e(),b.pathname)),V=()=>{const S=O(),C={};for(let R=0;R<S.length;R++)Object.assign(C,S[R].params);return C},T=o.paramsWrapper?o.paramsWrapper(V,e):Dt(V),D={pattern:u,path:()=>u,outlet:()=>null,resolvePath(S){return Se(u,S)}};return k(nt(s,S=>p("native",S),{defer:!0})),{base:D,location:b,params:T,isRouting:f,renderPath:a,parsePath:l,navigatorFactory:z,matches:O,beforeLeave:c,preloadRoute:Y,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:w};function M(S,C,R){U(()=>{if(typeof C=="number"){C&&(o.go?o.go(C):console.warn("Router integration does not support relative routing"));return}const le=!C||C[0]==="?",{replace:Fe,resolve:oe,scroll:Ve,state:fe}={replace:!1,resolve:!le,scroll:!0,...R},Pe=oe?S.resolvePath(C):Se(le&&b.pathname||"",C);if(Pe===void 0)throw new Error(`Path '${C}' is not a routable path`);if(y.length>=Mn)throw new Error("Too many redirects");const ct=d();(Pe!==ct||fe!==v())&&(Nn||c.confirm(Pe,R)&&(y.push({value:ct,replace:Fe,scroll:Ve,state:v()}),p("navigate",{value:Pe,state:fe})))})}function z(S){return S=S||an(Rt)||D,(C,R)=>M(S,C,R)}function q(S){const C=y[0];C&&(i({...S,replace:C.replace,scroll:C.scroll}),y.length=0)}function Y(S,C){const R=Xe(e(),S.pathname),le=se;se="preload";for(let Fe in R){const{route:oe,params:Ve}=R[Fe];oe.component&&oe.component.preload&&oe.component.preload();const{preload:fe}=oe;C&&fe&&St(n(),()=>fe({params:Ve,location:{pathname:S.pathname,search:S.search,hash:S.hash,query:Nt(S),state:null,key:""},intent:"preload"}))}se=le}}function Yn(t,e,n,r){const{base:s,location:i,params:o}=t,{pattern:l,component:a,preload:c}=r().route,u=E(()=>r().path);a&&a.preload&&a.preload();const f=c?c({params:o,location:i,intent:se||"initial"}):void 0;return{parent:e,pattern:l,path:u,outlet:()=>a?A(a,{params:o,location:i,data:f,get children(){return n()}}):n(),resolvePath(g){return Se(s.path(),g,u())}}}const Jn=t=>e=>{const{base:n}=e,r=rt(()=>e.children),s=E(()=>Vt(r(),e.base||""));let i;const o=Hn(t,s,()=>i,{base:n,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(o),A(Xn.Provider,{value:o,get children(){return A(Qn,{routerState:o,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[E(()=>(i=$t())&&null),A(Zn,{routerState:o,get branches(){return s()}})]}})}})};function Qn(t){const e=t.routerState.location,n=t.routerState.params,r=E(()=>t.preload&&U(()=>{t.preload({params:n,location:e,intent:Gn()||"initial"})}));return A(I,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:s=>A(s,{params:n,location:e,get data(){return r()},get children(){return t.children}})})}function Zn(t){const e=[];let n;const r=E(nt(t.routerState.matches,(s,i,o)=>{let l=i&&s.length===i.length;const a=[];for(let c=0,u=s.length;c<u;c++){const f=i&&i[c],h=s[c];o&&f&&h.route.key===f.route.key?a[c]=o[c]:(l=!1,e[c]&&e[c](),de(g=>{e[c]=g,a[c]=Yn(t.routerState,a[c-1]||t.routerState.base,mt(()=>r()[c+1]),()=>t.routerState.matches()[c])}))}return e.splice(s.length).forEach(c=>c()),o&&l?o:(n=a[0],a)}));return mt(()=>r()&&n)()}const mt=t=>()=>A(I,{get when(){return t()},keyed:!0,children:e=>A(Rt.Provider,{value:e,get children(){return e.outlet()}})}),yt=t=>{const e=rt(()=>t.children);return Ot(t,{get children(){return e()}})};function er([t,e],n,r){return[t,r?s=>e(r(s)):e]}function tr(t){let e=!1;const n=s=>typeof s=="string"?{value:s}:s,r=er($(n(t.get()),{equals:(s,i)=>s.value===i.value&&s.state===i.state}),void 0,s=>(!e&&t.set(s),s));return t.init&&we(t.init((s=t.get())=>{e=!0,r[1](n(s)),e=!1})),Jn({signal:r,create:t.create,utils:t.utils})}function nr(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function rr(t,e){const n=t&&document.getElementById(t);n?n.scrollIntoView():e&&window.scrollTo(0,0)}const sr=new Map;function ir(t=!0,e=!1,n="/_server",r){return s=>{const i=s.base.path(),o=s.navigatorFactory(s.base);let l,a;function c(d){return d.namespaceURI==="http://www.w3.org/2000/svg"}function u(d){if(d.defaultPrevented||d.button!==0||d.metaKey||d.altKey||d.ctrlKey||d.shiftKey)return;const m=d.composedPath().find(O=>O instanceof Node&&O.nodeName.toUpperCase()==="A");if(!m||e&&!m.hasAttribute("link"))return;const v=c(m),_=v?m.href.baseVal:m.href;if((v?m.target.baseVal:m.target)||!_&&!m.hasAttribute("state"))return;const y=(m.getAttribute("rel")||"").split(/\s+/);if(m.hasAttribute("download")||y&&y.includes("external"))return;const w=v?new URL(_,document.baseURI):new URL(_);if(!(w.origin!==window.location.origin||i&&w.pathname&&!w.pathname.toLowerCase().startsWith(i.toLowerCase())))return[m,w]}function f(d){const m=u(d);if(!m)return;const[v,_]=m,b=s.parsePath(_.pathname+_.search+_.hash),y=v.getAttribute("state");d.preventDefault(),o(b,{resolve:!1,replace:v.hasAttribute("replace"),scroll:!v.hasAttribute("noscroll"),state:y?JSON.parse(y):void 0})}function h(d){const m=u(d);if(!m)return;const[v,_]=m;r&&(_.pathname=r(_.pathname)),s.preloadRoute(_,v.getAttribute("preload")!=="false")}function g(d){clearTimeout(l);const m=u(d);if(!m)return a=null;const[v,_]=m;a!==v&&(r&&(_.pathname=r(_.pathname)),l=setTimeout(()=>{s.preloadRoute(_,v.getAttribute("preload")!=="false"),a=v},20))}function p(d){if(d.defaultPrevented)return;let m=d.submitter&&d.submitter.hasAttribute("formaction")?d.submitter.getAttribute("formaction"):d.target.getAttribute("action");if(!m)return;if(!m.startsWith("https://action/")){const _=new URL(m,Bt);if(m=s.parsePath(_.pathname+_.search),!m.startsWith(n))return}if(d.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const v=sr.get(m);if(v){d.preventDefault();const _=new FormData(d.target,d.submitter);v.call({r:s,f:d.target},d.target.enctype==="multipart/form-data"?_:new URLSearchParams(_))}}ee(["click","submit"]),document.addEventListener("click",f),t&&(document.addEventListener("mousemove",g,{passive:!0}),document.addEventListener("focusin",h,{passive:!0}),document.addEventListener("touchstart",h,{passive:!0})),document.addEventListener("submit",p),we(()=>{document.removeEventListener("click",f),t&&(document.removeEventListener("mousemove",g),document.removeEventListener("focusin",h),document.removeEventListener("touchstart",h)),document.removeEventListener("submit",p)})}}function lr(t){const e=()=>{const r=window.location.pathname.replace(/^\/+/,"/")+window.location.search,s=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:r+window.location.hash,state:s}},n=Tt();return tr({get:e,set({value:r,replace:s,scroll:i,state:o}){s?window.history.replaceState(Dn(o),"",r):window.history.pushState(o,"",r),rr(decodeURIComponent(window.location.hash.slice(1)),i),ot()},init:r=>nr(window,"popstate",In(r,s=>{if(s&&s<0)return!n.confirm(s);{const i=e();return!n.confirm(i.value,{state:i.state})}})),create:ir(t.preload,t.explicitLinks,t.actionBase,t.transformUrl),utils:{go:r=>window.history.go(r),beforeLeave:n}})(t)}const Qe=Symbol("store-raw"),ce=Symbol("store-node"),G=Symbol("store-has"),Kt=Symbol("store-self");function Ut(t){let e;return t!=null&&typeof t=="object"&&(t[X]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Oe(t,e=new Set){let n,r,s,i;if(n=t!=null&&t[Qe])return n;if(!Ut(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let o=0,l=t.length;o<l;o++)s=t[o],(r=Oe(s,e))!==s&&(t[o]=r)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const o=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let a=0,c=o.length;a<c;a++)i=o[a],!l[i].get&&(s=t[i],(r=Oe(s,e))!==s&&(t[i]=r))}return t}function Te(t,e){let n=t[e];return n||Object.defineProperty(t,e,{value:n=Object.create(null)}),n}function ve(t,e,n){if(t[e])return t[e];const[r,s]=$(n,{equals:!1,internal:!0});return r.$=s,t[e]=r}function Mt(t){Ge()&&ve(Te(t,ce),Kt)()}function or(t){return Mt(t),Reflect.ownKeys(t)}function pt(t,e,n,r=!1){if(!r&&t[e]===n)return;const s=t[e],i=t.length;n===void 0?(delete t[e],t[G]&&t[G][e]&&s!==void 0&&t[G][e].$()):(t[e]=n,t[G]&&t[G][e]&&s===void 0&&t[G][e].$());let o=Te(t,ce),l;if((l=ve(o,e,s))&&l.$(()=>n),Array.isArray(t)&&t.length!==i){for(let a=t.length;a<i;a++)(l=o[a])&&l.$();(l=ve(o,"length",i))&&l.$(t.length)}(l=o[Kt])&&l.$()}function ar(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||n.set||!n.configurable||e===X||e===ce||(delete n.value,delete n.writable,n.get=()=>t[X][e],n.set=r=>t[X][e]=r),n}const cr={get(t,e,n){if(e===Qe)return t;if(e===X)return n;if(e===We)return Mt(t),n;const r=Te(t,ce),s=r[e];let i=s?s():t[e];if(e===ce||e===G||e==="__proto__")return i;if(!s){const o=Object.getOwnPropertyDescriptor(t,e),l=typeof i=="function";if(Ge()&&(!l||t.hasOwnProperty(e))&&!(o&&o.get))i=ve(r,e,i)();else if(i!=null&&l&&i===Array.prototype[e])return(...a)=>ge(()=>Array.prototype[e].apply(n,a))}return Ut(i)?Xt(i):i},has(t,e){return e===Qe||e===X||e===We||e===ce||e===G||e==="__proto__"?!0:(Ge()&&ve(Te(t,G),e)(),e in t)},set(t,e,n){return ge(()=>pt(t,e,Oe(n))),!0},deleteProperty(t,e){return ge(()=>pt(t,e,void 0,!0)),!0},ownKeys:or,getOwnPropertyDescriptor:ar};function Xt(t){let e=t[X];if(!e){Object.defineProperty(t,X,{value:e=new Proxy(t,cr)});const n=Object.keys(t),r=Object.getOwnPropertyDescriptors(t),s=Object.getPrototypeOf(t),i=s!==null&&t!==null&&typeof t=="object"&&!Array.isArray(t)&&s!==Object.prototype;if(i){const o=Object.getOwnPropertyDescriptors(s);n.push(...Object.keys(o)),Object.assign(r,o)}for(let o=0,l=n.length;o<l;o++){const a=n[o];if(!(i&&a==="constructor")){if(r[a].get){const c=r[a].get.bind(e);Object.defineProperty(t,a,{get:c,configurable:!0})}if(r[a].set){const c=r[a].set;Object.defineProperty(t,a,{set:f=>ge(()=>c.call(e,f)),configurable:!0})}}}}return e}function bt(t,e){const n=Oe(t||{});return Xt(n)}var ur=B("<div class=appFileDragDrop><div>");const Ze=t=>{let e;const[n,r]=$(!1),s=new AbortController,i=c=>{let u=[...c].filter(f=>f.kind==="file").map(f=>f.getAsFile());if(!u||u.length===0)return[];if(!t.multiple&&u.length!==1)return[];if(typeof t.accept=="string"){const f=t.accept.split(/\s+/);u=u.filter(h=>f.some(g=>g.includes(".")?h.name.endsWith(g):h.type.startsWith(g)))}else t.accept&&(u=u.filter(f=>t.accept.test(f.name)));return u},o=c=>{c.preventDefault(),c.stopPropagation(),r(!0)},l=c=>{c.preventDefault(),c.stopPropagation(),r(!1)},a=c=>{if(c.preventDefault(),c.stopPropagation(),r(!1),c.dataTransfer){const u=i(c.dataTransfer.items);if(u.length===0)return;t.multiple&&t.setFiles?t.setFiles(u):!t.multiple&&u.length===1&&t.setFile&&t.setFile(u[0])}};return xt(()=>{e?.addEventListener("dragover",o,{signal:s.signal}),e?.addEventListener("dragleave",l,{signal:s.signal}),e?.addEventListener("drop",a,{signal:s.signal})}),we(()=>{s.abort()}),(()=>{var c=ur(),u=c.firstChild,f=e;return typeof f=="function"?lt(f,u):e=u,x(u,()=>t.children??"ファイルをドラッグ＆ドロップ"),k(h=>{var g=`appFileDragDropArea ${t.class??""}`,p={appFileDragDropOver:n(),...t.classList};return g!==h.e&&P(u,h.e=g),h.t=Ae(u,p,h.t),h},{e:void 0,t:void 0}),c})()};var fr=B('<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=currentColor viewBox="0 0 16 16"><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708">'),hr=B('<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=currentColor viewBox="0 0 16 16"><path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"></path><path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z">');const zt=(t,e)=>t?e?`${t} ${e}`:t:e||"",et=t=>(()=>{var e=fr();return k(()=>pe(e,"class",zt(t.class,"bi bi-x"))),e})(),dr=t=>(()=>{var e=hr();return k(()=>pe(e,"class",zt(t.class,"bi bi-download"))),e})(),gr=(t,e,n=0)=>{const r=t.length,s=e.length;if(s===0)return 0;let i=n;for(;i<=r-s;){let o=0;for(;o<s&&e[o]===t[i+o];)o++;if(o===s)return i;if(i+s<r){const l=t[i+s];let a=s-1;for(;a>=0&&e[a]!==l;)a--;a<0?i+=s+1:i+=s-a}else break}return-1},mr=(t,e,n=0)=>gr(t,new Uint8Array(e),n),ze=t=>{let e=0;return t.forEach((n,r)=>{e+=n*256**r}),e},yr=t=>{if(t.length<8)throw new Error("not double");const e=t.buffer,n=t.byteOffset;return new DataView(e,n,t.byteLength).getFloat64(0,!0)},De=t=>new TextEncoder().encode(t),ie=(t,e=!1)=>{if(t<0||!Number.isInteger(t))throw new Error("not uint");const n=[];let r=t;for(;r>0;)n.push(r&255),r>>=8;return!e&&n.length===0?new Uint8Array([0]):new Uint8Array(n)},pr=t=>{if(!Number.isInteger(t))throw new Error("not int");const e=new ArrayBuffer(4);return new DataView(e).setInt32(0,t,!0),new Uint8Array(e)},br=t=>{const e=new ArrayBuffer(8);return new DataView(e).setFloat64(0,t,!0),new Uint8Array(e)},Ie=(...t)=>{const e=[];let n=0;for(const i of t){const o=typeof i=="number"?ie(i):i;e.push(o),n+=o.length}const r=new Uint8Array(n);let s=0;for(const i of e)r.set(i,s),s+=i.length;return r},vr=t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{if(typeof r.result=="string"){const s=new TextEncoder;e(s.encode(r.result).buffer)}e(r.result)},r.onerror=()=>{n(r.error)},r.readAsArrayBuffer(t)}),wr=t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{e(r.result)},r.onerror=()=>{n(r.error)},r.readAsText(t)}),qt=(t,e,n="application/octet-stream")=>{const r=new Blob([t],{type:n}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)},K={int:1,double:4,string:5};class Wt{_file;obj;_isParsing;_isParsed;constructor(e){this._file=e}parse=async()=>{if(this._isParsing)return!1;try{this._isParsing=!0;const e=new Uint8Array(await vr(this._file));if(e.length===0)return this.obj=null,this._isParsed=!1,!1;const n=(c,u=0)=>mr(e,[c],u),r=new TextDecoder("utf-8"),s=c=>r.decode(c),i=c=>/^[a-z]/.test(c),o=new Be({key:"root",attributeLength:-1,childLength:-1});let l=o,a=0;e:for(;;){for(;e[a]===0;){for(;l.attributeLength===l.attributes.length&&l.childLength===l.children.length;){if(l.parent==null)break e;l=l.parent}a++}if(e[a]<16){const g=e[a];let p=ze(e.slice(a+1,a+1+g));l.childLength=p,a+=1+g}const c=n(0,a);if(c===-1)break;const u=s(e.slice(a,c)),f=e[c+1],h=ze(e.slice(c+2,c+2+f));if(i(u)){const g=e[c+2+f];let p=h;const d=()=>e.slice(c+2+f+1,c+2+f+1+p);let m;switch(g){case K.int:p-=2,m=this.newAttribute(g,u,ze(d()),l);break;case K.double:p-=1,m=this.newAttribute(g,u,yr(d()),l);break;case K.string:p-=2,m=this.newAttribute(g,u,s(d()),l);break}l.attributes.push(m),a=c+2+f+h}else{const g=new Be({key:u,parent:l,attributeLength:h,childLength:0});l.children.push(g),l=g,a=c+2+f}}return this.obj=o.children.length>0?o.children[0]:null,this._isParsed=!0,!0}catch{return this._isParsed=!1,!1}finally{this._isParsing=!1}};newAttribute=(e,n,r,s)=>{switch(e){case K.int:return new Gt(n,r,s);case K.double:return new Ht(n,r,s);case K.string:switch(n){case"tsml":return new Yt(n,r,s);default:return new Re(n,r,s)}}};serialize=async()=>this.obj.serialize();toXml=async(e=!1)=>this.obj.toXml(e);findElements=e=>this.obj.findElements(e);getElementsByKeyPath=e=>this.obj.getElementsByKeyPath(e);getAttributesByKeyPath=e=>this.obj.getAttributesByKeyPath(e);get file(){return this._file}get isParsing(){return this._isParsing}get isParsed(){return this._isParsed}}class Be{key;parent;attributeLength;childLength;attributes;children;constructor(e){this.key=e.key,this.parent=e.parent??null,this.attributeLength=e.attributeLength??0,this.childLength=e.childLength??0,this.attributes=e.attributes??[],this.children=e.children??[]}serialize=()=>{const e=De(this.key),n=ie(this.attributes.length,!0),r=ie(n.byteLength),s=this.attributes.map(c=>c.serialize()),i=ie(this.children.length),o=ie(i.byteLength),l=this.children.map(c=>c.serialize()),a=[];return a.push(e,0,r,n,...s),this.children.length>0?a.push(o,i,...l):a.push(0),Ie(...a)};toXml=(e=!1)=>`<${this.key}${this.attributes.length===0?"":` ${this.attributes.map(n=>n.toXml(e)).join(" ")}`}${this.children.length===0?" />":`>${this.children.map(n=>n.toXml(e)).join("")}</${this.key}>`}`;findElements=e=>this.children.filter(n=>e(n));getElementsByKeyPath=e=>{const n=typeof e=="string"?e.split("."):e,r=this.children.filter(s=>s.key===n[0]);return n.length===1?r:r.flatMap(s=>s.getElementsByKeyPath(n.slice(1)))};getAttributesByKeyPath=e=>{const n=typeof e=="string"?e.split("."):e;return n.length===1?this.attributes.filter(r=>r.key===n[0]):this.children.filter(r=>r.key===n[0]).flatMap(r=>r.getAttributesByKeyPath(n.slice(1)))}}class at{key;type;_value;parent;serializeValue;toXmlValue;constructor(e,n,r){this.key=e,this._value=n,this.parent=r??null}serialize=()=>{const e=De(this.key),n=this.serializeValue(),r=ie(n.byteLength+1),s=ie(r.byteLength);return Ie(e,0,s,r,this.type,n)};toXml=(e=!1)=>`${this.key}="${this.toXmlValue(e)}"`;get value(){return this._value}set value(e){this._value=e}}class Gt extends at{type=K.int;constructor(e,n,r){super(e,n,r??null)}serializeValue=()=>pr(this.value);toXmlValue=()=>this.value.toString();get value(){return this._value}set value(e){this._value=e}}class Ht extends at{type=K.double;constructor(e,n,r){super(e,n,r??null)}serializeValue=()=>br(this.value);toXmlValue=()=>this.value.toString();get value(){return this._value}set value(e){this._value=e}}class Re extends at{type=K.string;constructor(e,n,r){super(e,n,r??null)}serializeValue=()=>Ie(De(this.value),0);toXmlValue=(e=!1)=>e?this.value.replaceAll('"',"&quot;").replaceAll("'","&apos;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll("&","&amp;"):this.value;get value(){return this._value}set value(e){this._value=e}}class Yt extends Re{tsml=null;_isParsing;_isParsed;parseTsml=async()=>{if(this._isParsing)return!1;try{this._isParsing=!0;const n=new DOMParser().parseFromString(`<tsml>${this.value}</tsml>`,"text/xml"),r=this.parseNode(n,null).children[0];return r.parent=null,this.tsml=r,this._isParsed=!0,!0}catch{return this._isParsed=!1,!1}finally{this._isParsing=!1}};parseNode=(e,n)=>{const r=this.newElement(e.nodeName,n);if(e.nodeType===Node.TEXT_NODE)return r.key="",r.value=e.nodeValue,r;if(e instanceof Element){const s=e.attributes;if(s)for(let i=0;i<s.length;i++){const o=s.item(i);o&&r.attributes.push(this.newAttribute(o.nodeName,o.nodeValue,r))}}return e.childNodes.forEach(s=>{r.children.push(this.parseNode(s,r))}),r};newElement=(e,n)=>new Jt({key:e,parent:n});newAttribute=(e,n,r)=>new Qt(e,n,r);getElementsByKeyPath=e=>this.tsml.getElementsByKeyPath(e);getAttributesByKeyPath=e=>this.tsml.getAttributesByKeyPath(e);serializeValue=()=>(this.value=this.toXml(),Ie(De(this.value),0));toXml=(e=!1)=>this.tsml.toXml(e).replaceAll(/(^<tsml>)|(<\/tsml>$)/g,"");get isParsing(){return this._isParsing}get isParsed(){return this._isParsed}}class Jt{key;_value;_parent;_attributes;_children;constructor(e){this.key=e.key,this._value=e.value,this._parent=e.parent??null,this._attributes=e.attributes??[],this._children=e.children??[]}getElementsByKeyPath=e=>{const n=typeof e=="string"?e.split("."):e,r=this.children.filter(s=>s.key===n[0]);return n.length===1?r:r.flatMap(s=>s.getElementsByKeyPath(n.slice(1)))};getAttributesByKeyPath=e=>{const n=typeof e=="string"?e.split("."):e;return n.length===1?this.attributes.filter(r=>r.key===n[0]):this.children.filter(r=>r.key===n[0]).flatMap(r=>r.getAttributesByKeyPath(n.slice(1)))};toXml=(e=!1)=>this.key===""?e?this.value.replaceAll('"',"&quot;").replaceAll("'","&apos;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll("&","&amp;"):this.value:`<${this.key}${this.attributes.length===0?"":` ${this.attributes.map(n=>n.toXml(e)).join(" ")}`}${this.children.length===0?" />":`>${this.children.map(n=>n.toXml(e)).join("")}</${this.key}>`}`;get value(){return this._value}set value(e){this._value=e}get parent(){return this._parent}set parent(e){this._parent=e}get attributes(){return this._attributes}set attributes(e){this._attributes=e}get children(){return this._children}set children(e){this._children=e}}class Qt{key;_value;_parent;constructor(e,n,r){this.key=e,this._value=n,this._parent=r??null}toXmlValue=(e=!1)=>e?this.value.replaceAll('"',"&quot;").replaceAll("'","&apos;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll("&","&amp;"):this.value;toXml=(e=!1)=>`${this.key}="${this.toXmlValue(e)}"`;get value(){return this._value}set value(e){this._value=e}get parent(){return this._parent}set parent(e){this._parent=e}}class _r extends Wt{newAttribute=(e,n,r,s)=>{switch(e){case K.int:return new Ar(n,r,s);case K.double:return new Pr(n,r,s);case K.string:switch(n){case"tsml":return new xr(n,r,s);default:return new Zt(n,r,s)}}}}class Ar extends Gt{signalValue;constructor(e,n,r){super(e,n,r??null),this.signalValue=$(n)}get value(){return this.signalValue[0]()}set value(e){this.signalValue[1](e)}}class Pr extends Ht{signalValue;constructor(e,n,r){super(e,n,r??null),this.signalValue=$(n)}get value(){return this.signalValue[0]()}set value(e){this.signalValue[1](e)}}class Zt extends Re{signalValue;constructor(e,n,r){super(e,n,r??null),this.signalValue=$(n)}get value(){return this.signalValue[0]()}set value(e){this.signalValue[1](e)}}class xr extends Yt{signalValue;constructor(e,n,r){super(e,n,r??null),this.signalValue=$(n)}get value(){return this.signalValue[0]()}set value(e){this.signalValue[1](e)}newElement=(e,n)=>new $r({key:e,parent:n});newAttribute=(e,n,r)=>new Sr(e,n,r)}class $r extends Jt{signalParent;constructor(e){super({...e,attributes:bt(e.attributes??[]),children:bt(e.children??[])}),this.signalParent=$(this._parent)}get parent(){return this.signalParent[0]()}set parent(e){this.signalParent[1](e)}}class Sr extends Qt{signalValue;signalParent;constructor(e,n,r){super(e,n,r??null),this.signalValue=$(n),this.signalParent=$(r??null)}get value(){return this.signalValue[0]()}set value(e){this.signalValue[1](e)}get parent(){return this.signalParent[0]()}set parent(e){this.signalParent[1](e)}}const Er="_groups_kawjd_1",Lr="_words_kawjd_16",kr="_charBox_kawjd_23",Cr="_h_kawjd_35",Ee={groups:Er,words:Lr,charBox:kr,h:Cr};var tt=B("<div>");const jr=t=>(()=>{var e=tt();return x(e,A(J,{get each(){return t.accentGroup},children:n=>(()=>{var r=tt();return r.$$click=()=>{const s=n.hl[0]()==="h"?"l":"h";n.hlAttribute.value=n.hlAttribute.value.slice(0,n.hlIdx)+s+n.hlAttribute.value.slice(n.hlIdx+1)},x(r,()=>n.pronunciation),k(s=>{var i=Ee.charBox,o={[Ee.h]:n.hl[0]()==="h"};return i!==s.e&&P(r,s.e=i),s.t=Ae(r,o,s.t),s},{e:void 0,t:void 0}),r})()})),k(()=>P(e,Ee.words)),e})(),Or=t=>{const e=E(()=>{const s=t.tsml.getElementsByKeyPath("acoustic_phrase.word"),i=[];let o;return s.forEach(l=>{const a=l.getAttributesByKeyPath("chain");(!o||a.length>0&&a[0].value==="0")&&(i.push([]),o=i.at(-1));const c=l.getAttributesByKeyPath("hl"),u=l.getAttributesByKeyPath("pronunciation");if(c.length>0&&u.length>0){const f=[...u[0].value].filter(h=>h!=="’");[...c[0].value].forEach((h,g)=>{o.push({hlIdx:g,hl:$(h==="h"?"h":"l"),pronunciation:f[g],hlAttribute:c[0]})})}}),i});let n=null;const r=s=>{s.deltaY!==0&&(s.preventDefault(),n.scrollLeft+=s.deltaY)};return xt(()=>{n?.addEventListener("wheel",r)}),we(()=>{n?.removeEventListener("wheel",r)}),(()=>{var s=tt(),i=n;return typeof i=="function"?lt(i,s):n=s,x(s,A(J,{get each(){return e()},children:o=>A(jr,{accentGroup:o})})),k(()=>P(s,Ee.groups)),s})()};ee(["click"]);const Tr="_tabContainer_1jnse_1",Br="_tab_1jnse_1",Nr="_selected_1jnse_19",Dr="_editor_1jnse_23",$e={tabContainer:Tr,tab:Br,selected:Nr,editor:Dr};var Ir=B("<input>");const Rr=t=>{const[e,n]=$(Number(t.signal?t.signal[0]():NaN)),r=i=>{const o=i.target.value.replaceAll(/[０-９]/g,a=>String.fromCharCode(a.charCodeAt(0)-65248)).replaceAll(/^[－ー−ｰ]/g,"-").replaceAll(/^[＋+]/g,"").replaceAll(/[．。]/g,".").replaceAll(/[，、]/g,"").replaceAll(/\s+/g,"");let l=Number(o);if(isNaN(l)){const a=e();n(NaN),n(a),t.signal&&t.signal[1](e()),t.onChange&&t.onChange[0](i);return}console.log("valid"),t.min!=null&&(l=Math.max(Number(t.min),l)),t.max!=null&&(l=Math.min(Number(t.max),l)),n(NaN),n(l),t.signal&&t.signal[1](e()),t.onChange&&t.onChange[0](i)},s=()=>e()==null||isNaN(e())?"":e();return(()=>{var i=Ir();return jn(i,Ot(t,{type:"text",onChange:r,get value(){return s()}}),!1),i})()},Fr="_root_ffo0m_1",Vr="_menuRoot_ffo0m_5",Kr="_menu_ffo0m_5",Ur="_menuForm_ffo0m_18",Mr="_input_ffo0m_24",Xr="_timeSignature_ffo0m_36",zr="_select_ffo0m_42",qr="_option_ffo0m_53",Wr="_noteRole_ffo0m_56",F={root:Fr,menuRoot:Vr,menu:Kr,menuForm:Ur,input:Mr,timeSignature:Xr,select:zr,option:qr,noteRole:Wr};var Gr=B("<div><div><div><div><label>BPM</label></div><div><label>拍子</label><div><select></select><span>/</span><select></select></div></div></div><div>工事中</div></div><div>工事中"),vt=B("<option>");const Hr=t=>{const e=$(120),[n,r]=$(4),[s,i]=$(4);console.log(t.duration),console.log(t.originalDuration),E(()=>{t.originalDuration.value.split(",").map(u=>Number(u));const a=t.tsml.getAttributesByKeyPath("acoustic_phrase.word.phoneme");let c=1;a.flatMap(u=>u.value.split(/[,|]/).map((f,h)=>({durationIdx:c++,duration:0,originalDuration:0,phoneme:f,durationAttribute:t.duration})))});const o=Array(16).fill(0).map((a,c)=>c+1),l=Array(4).fill(0).map((a,c)=>2**(c+1));return(()=>{var a=Gr(),c=a.firstChild,u=c.firstChild,f=u.firstChild;f.firstChild;var h=f.nextSibling,g=h.firstChild,p=g.nextSibling,d=p.firstChild,m=d.nextSibling,v=m.nextSibling,_=u.nextSibling,b=c.nextSibling;return x(f,A(Rr,{get class(){return F.input},min:1,max:999,signal:e}),null),d.addEventListener("change",y=>r(Number(y.target.value))),x(d,A(J,{each:o,children:y=>(()=>{var w=vt();return w.value=y,w.selected=y===4,x(w,y),k(()=>P(w,F.option)),w})()})),v.addEventListener("change",y=>i(Number(y.target.value))),x(v,A(J,{each:l,children:y=>(()=>{var w=vt();return w.value=y,w.selected=y===4,x(w,y),k(()=>P(w,F.option)),w})()})),k(y=>{var w=F.root,O=F.menuRoot,V=F.menu,T=F.menuForm,D=F.menuForm,M=F.timeSignature,z=F.select,q=F.select,Y=F.menu,S=F.noteRole;return w!==y.e&&P(a,y.e=w),O!==y.t&&P(c,y.t=O),V!==y.a&&P(u,y.a=V),T!==y.o&&P(f,y.o=T),D!==y.i&&P(h,y.i=D),M!==y.n&&P(p,y.n=M),z!==y.s&&P(d,y.s=z),q!==y.h&&P(v,y.h=q),Y!==y.r&&P(_,y.r=Y),S!==y.d&&P(b,y.d=S),y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),a})()};var Yr=B("<div><div></div><div>"),Jr=B("<div>");const Qr=t=>{const[e,n]=$(0),[r,s]=$(),[i,o]=$(),[l,a]=$(),c=E(()=>[{name:"タイミング",child:A(I,{get when(){return E(()=>!!(t.tsml&&r()&&i()))()&&l()},get children(){return A(Hr,{get tsml(){return t.tsml},get duration(){return r()},get originalDuration(){return i()},get start(){return l()}})}})},{name:"アクセント",child:A(Or,{get tsml(){return t.tsml}})}]);return ue(()=>{if(t.tsml){const u=t.tsml.parent.getAttributesByKeyPath("PhonemeDuration.values");if(u.length>0)s(u[0]);else{const g=new Be({key:"PhonemeDuration",parent:t.tsml.parent,attributeLength:1,childLength:0}),p=new Zt("values","",g);g.attributes.push(),t.tsml.parent.children.push(g),s(p)}const f=t.tsml.parent.getAttributesByKeyPath("PhonemeOriginalDuration.values");f.length>0&&o(f[0]);const h=t.tsml.parent.getAttributesByKeyPath("start");h.length>0&&a(h[0])}}),(()=>{var u=Yr(),f=u.firstChild,h=f.nextSibling;return x(f,A(J,{get each(){return c()},children:(g,p)=>(()=>{var d=Jr();return d.$$click=()=>n(p()),x(d,()=>g.name),k(m=>{var v=$e.tab,_={[$e.selected]:p()===e()};return v!==m.e&&P(d,m.e=v),m.t=Ae(d,_,m.t),m},{e:void 0,t:void 0}),d})()})),x(h,A(I,{get when(){return c()?.length>e()},get children(){return c()[e()].child}})),k(g=>{var p=t.class,d=$e.tabContainer,m=$e.editor;return p!==g.e&&P(u,g.e=p),d!==g.t&&P(f,g.t=d),m!==g.a&&P(h,g.a=m),g},{e:void 0,t:void 0,a:void 0}),u})()};ee(["click"]);const Zr="_table_hfr5r_1",es="_selected_hfr5r_21",wt={table:Zr,selected:es};var ts=B("<div><table><thead><tr><th>トラック</th><th>ボイス</th><th>テキスト</th></tr></thead><tbody>"),ns=B("<tr><td></td><td></td><td>");const rs=t=>{const[e,n]=$(-1),r=E(()=>t.tstprj.getElementsByKeyPath("Tracks.Track.Contents.Utterance")),s=E(()=>r().map(o=>{const l=o.parent.parent.getAttributesByKeyPath("name"),a=o.parent.parent.getAttributesByKeyPath("Voice.speaker"),c=o.getAttributesByKeyPath("text");return{track:l.length>0?l[0].value:"",voice:a.length>0?a[0].value:"",text:c.length>0?c[0].value:""}})),i=async o=>{if(n(o),e()<0)return;const l=r()[e()].getAttributesByKeyPath("tsml");if(l.length===0){t.setTsml(void 0);return}const a=l[0];await a.parseTsml()&&t.setTsml(a)};return(()=>{var o=ts(),l=o.firstChild,a=l.firstChild,c=a.nextSibling;return x(c,A(J,{get each(){return s()},children:(u,f)=>(()=>{var h=ns(),g=h.firstChild,p=g.nextSibling,d=p.nextSibling;return h.$$click=()=>i(f()),x(g,()=>u.track),x(p,()=>u.voice),x(d,()=>u.text),k(m=>Ae(h,{[wt.selected]:f()===e()},m)),h})()})),k(u=>{var f=t.class,h=wt.table;return f!==u.e&&P(o,u.e=f),h!==u.t&&P(l,u.t=h),u},{e:void 0,t:void 0}),o})()};ee(["click"]);const ss="_fileBox_16cb5_1",is="_fileName_16cb5_11",ls="_iconButton_16cb5_14",os="_clearIcon_16cb5_19",as="_downloadIcon_16cb5_25",cs="_utteranceList_16cb5_36",te={fileBox:ss,fileName:is,iconButton:ls,clearIcon:os,downloadIcon:as,utteranceList:cs};var us=B("<div><div></div><div></div><div>"),fs=B("<main>");const hs=()=>{const[t,e]=$(void 0),[n,r]=$(void 0),[s,i]=$(!1),[o,l]=$(void 0),a=()=>{confirm(`保存していないデータは失われます。
よろしいですか？`)&&(e(void 0),r(void 0),i(!1),l(void 0))},c=async()=>{qt(await n().serialize(),t().name)};return ue(async()=>{t()&&(i(!1),r(new _r(t())),i(await n().parse()))}),(()=>{var u=fs();return x(u,A(I,{get when(){return!n()},get children(){return A(Ze,{accept:".tstprj",setFile:e})}}),null),x(u,A(I,{get when(){return E(()=>!!n())()&&t()},get children(){var f=us(),h=f.firstChild,g=h.nextSibling,p=g.nextSibling;return h.$$click=c,x(h,A(dr,{get class(){return te.downloadIcon}})),g.$$click=a,x(g,A(et,{get class(){return te.clearIcon}})),x(p,()=>t().name),k(d=>{var m=te.fileBox,v=te.iconButton,_=te.iconButton,b=te.fileName;return m!==d.e&&P(f,d.e=m),v!==d.t&&P(h,d.t=v),_!==d.a&&P(g,d.a=_),b!==d.o&&P(p,d.o=b),d},{e:void 0,t:void 0,a:void 0,o:void 0}),f}}),null),x(u,A(I,{get when(){return E(()=>!!n())()&&s()},get children(){return A(rs,{get class(){return te.utteranceList},get tstprj(){return n()},setTsml:l})}}),null),x(u,A(I,{get when(){return o()},get children(){return A(Qr,{get tsml(){return o()}})}}),null),u})()};ee(["click"]);const en=(t,e)=>{const n=typeof e=="string"?e.split("."):e;if(n.length>0&&t.nodeName!==n[0])return[];if(t instanceof Element){if(n.length===1)return[t];const r=n.slice(1);return[...t.children].flatMap(s=>en(s,r))}else return[]},qe=(t,e)=>t instanceof Element||t instanceof Document?[...t.children].flatMap(n=>en(n,e)):[],tn=(t,e)=>{const n=typeof e=="string"?e.split("."):e;if(n.length>0&&t.nodeName!==n[0])return[];if(t instanceof Attr&&n.length===1)return[t];if(t instanceof Element){if(n.length<2)return[];const r=n.slice(1);return[...t.childNodes].flatMap(s=>tn(s,r))}else return[]},ne=(t,e)=>{const n=typeof e=="string"?e.split("."):e;return t instanceof Element?(n.length>1?[...t.children]:[...t.attributes]).flatMap(r=>tn(r,n)):[]},he=(t,e,n)=>{const r={};t.value.split(",").forEach(i=>{const o=i.split(":");o.length===2&&(r[Number(o[0])]=Number(o[1]))}),r[e]=n,t.value=Object.keys(r).map(i=>[Number(i),r[Number(i)]]).sort((i,o)=>i[0]-o[0]).map(i=>`${i[0].toFixed(3)}:${i[1].toFixed(3)}`).join(",")},ds="_setView_1rej1_1",gs="_group_1rej1_9",ms="_noteCharSet_1rej1_14",ys="_lyric_1rej1_22",ps="_pronunciation_1rej1_26",bs="_phoneme_1rej1_29",vs="_save_1rej1_33",re={setView:ds,group:gs,noteCharSet:ms,lyric:ys,pronunciation:ps,phoneme:bs,save:vs};var ws=B("<div>保存"),_s=B("<div><div>"),As=B("<div>"),Ps=B("<div><div></div><div></div><div>");const xs=t=>{const[e,n]=$(null),[r,s]=$(!1),[i,o]=$(!1),l=E(()=>{try{const h=qe(t.ccs,"Scenario.Sequence.Scene.Units.Unit").filter(b=>{const y=ne(b,"Category");return y.length>0&&y[0].value==="SingerSong"});if(h.length===0)return[];const g=qe(h[0],"Song.Tempo.Sound").map(b=>({clock:Number(ne(b,"Clock")[0].value),bpm:Number(ne(b,"Tempo")[0].value)})).sort((b,y)=>b.clock-y.clock);if(g.length===0)return[];let p=-1,d=-1,m=-1;const v=qe(h[0],"Song.Score.Note").map(b=>{const y=Number(ne(b,"Clock")[0].value),w=Number(ne(b,"Duration")[0].value),O=ne(b,"Lyric"),V=Number(ne(b,"PitchStep")[0].value);let T=120,D=0,M=0,z=0,q=w,Y=!1;for(const S of g){if(S.clock>y){const C=Math.min(y-S.clock,q);if(z+=C/16/T,q-=C,Y||(M+=(y-D)/16/T,Y=!0),q<=0)break}M+=(S.clock-D)/16/T,D=S.clock,T=S.bpm}return Y||(M+=(y-D)/16/T),q>0&&(z+=q/16/T),(d!==y||m!==V)&&p++,d=y+w,m=V,{previous:null,group:p,offset:M,length:z,lyric:O.length>0?O[0].value:"_"}});let _=-1;return v.forEach((b,y)=>{b.group===_?b.previous=v[y-1]:_=b.group}),v}catch{return[]}}),a=E(()=>{try{return e().flatMap((h,g)=>{const p=h.getElementsByKeyPath("acoustic_phrase.word"),d=h.parent.getAttributesByKeyPath("PhonemeOriginalDuration.values")[0].value.split(","),m=h.parent.getAttributesByKeyPath("PhonemeDuration.values");let v;if(m.length===0){const y=new Be({key:"PhonemeDuration",parent:h.parent,attributeLength:1,childLength:0});v=new Re("values","",y),y.attributes.push(v),h.parent.children.push(y)}else v=m[0];let _=0;const b=p.flatMap(y=>{const w=[];[...y.getAttributesByKeyPath("pronunciation")[0].value].forEach(T=>{T!=="’"||w.length===0?w.push(T):w[w.length-1]+=T});const O=y.getAttributesByKeyPath("phoneme")[0].value.split("|");return w.map((T,D)=>{const M=O[D].split(",").map(z=>({phoneme:z,durationIndex:++_,originalDuration:Number(d[_])}));return{previous:null,next:null,group:g,char:T,phonemes:M,duration:v}})});return b.forEach((y,w)=>{y.previous=w!==0?b[w-1]:null,y.next=w!==b.length-1?b[w+1]:null}),b})}catch{return[]}}),c=E(()=>{let h=!0;const g=a().slice(0,Math.min(a().length,l().length)).map((p,d)=>(p.group!==l()[d].group&&(h=!1),{note:l()[d],char:p}));return s(h),g.reduce((p,d)=>{const m=p.find(v=>v.length>0&&v[0].note.group===d.note.group);return m?m.push(d):p.push([d]),p},[])});ue(async()=>{try{if(!e()){const h=t.tstprj.getElementsByKeyPath("Tracks.Track");if(h.length===0)return;const g=h[0].getElementsByKeyPath("Contents.Utterance");if(g.length===0)return;const p=g.map(d=>d.getAttributesByKeyPath("tsml").length>0?d.getAttributesByKeyPath("tsml")[0]:null).filter(d=>d!=null);for(const d of p)if(!await d.parseTsml())return;n(p)}}catch{}});const u=()=>{c().flat().forEach(h=>{const g=h.char.previous==null,p=h.char.phonemes.length===1;let d=0;if(p)he(h.char.duration,h.char.phonemes[0].durationIndex,h.note.length),h.char.phonemes[0].fixedDuration=h.note.length;else{if(g)h.char.phonemes.slice(0,-1).forEach(m=>{m.fixedDuration=m.originalDuration,he(h.char.duration,m.durationIndex,m.fixedDuration),d+=m.fixedDuration});else{const m=h.char.previous,v=m.phonemes.at(-1).fixedDuration??m.phonemes.at(-1).originalDuration,_=h.char.phonemes.slice(0,-1).reduce((y,w)=>y+w.originalDuration,0),b=Math.min(_,v/2)/_;m.phonemes.at(-1).fixedDuration-=Math.min(_,v/2),he(m.duration,m.phonemes.at(-1).durationIndex,m.phonemes.at(-1).fixedDuration),h.char.phonemes.slice(0,-1).forEach(y=>{y.fixedDuration=y.originalDuration*b,he(h.char.duration,y.durationIndex,y.fixedDuration),d+=y.fixedDuration})}he(h.char.duration,h.char.phonemes.at(-1).durationIndex,h.note.length),h.char.phonemes.at(-1).fixedDuration=h.note.length}g&&(h.char.duration.parent.parent.getAttributesByKeyPath("start")[0].value=(h.note.offset-d-.005).toFixed(3))}),o(!0)},f=async()=>{i()||u(),qt(await t.tstprj.serialize(),t.filename)};return(()=>{var h=_s(),g=h.firstChild;return x(g,A(J,{get each(){return c()},children:p=>(()=>{var d=As();return x(d,A(J,{each:p,children:m=>(()=>{var v=Ps(),_=v.firstChild,b=_.nextSibling,y=b.nextSibling;return x(_,()=>m.note.lyric),x(b,()=>m.char.char),x(y,()=>m.char.phonemes.map(w=>w.phoneme).join(",")),k(w=>{var O=re.noteCharSet,V=re.lyric,T=re.pronunciation,D=re.phoneme;return O!==w.e&&P(v,w.e=O),V!==w.t&&P(_,w.t=V),T!==w.a&&P(b,w.a=T),D!==w.o&&P(y,w.o=D),w},{e:void 0,t:void 0,a:void 0,o:void 0}),v})()})),k(()=>P(d,re.group)),d})()})),x(h,A(I,{get when(){return E(()=>c().length>0)()&&r()},get children(){var p=ws();return p.$$click=f,k(()=>P(p,re.save)),p}}),null),k(()=>P(g,re.setView)),h})()};ee(["click"]);const $s="_fileContainer_k0iag_1",Ss="_fileBox_k0iag_7",Es="_fileName_k0iag_16",Ls="_iconButton_k0iag_19",ks="_clearIcon_k0iag_24",Cs="_downloadIcon_k0iag_30",W={fileContainer:$s,fileBox:Ss,fileName:Es,iconButton:Ls,clearIcon:ks,downloadIcon:Cs};var _t=B("<div><div></div><div>"),js=B("<main><div>");const Os=()=>{const[t,e]=$(void 0),[n,r]=$(void 0),[s,i]=$(void 0),[o,l]=$(void 0),[a,c]=$(!1),[u,f]=$(!1),h=()=>{e(void 0),i(void 0),c(!1)},g=()=>{r(void 0),l(void 0),f(!1)};return ue(async()=>{t()&&(c(!1),i(new Wt(t())),c(await s().parse()))}),ue(async()=>{if(n()){f(!1);try{const p=await wr(n()),m=new DOMParser().parseFromString(p,"application/xml");l(m),f(!0)}catch{return}}}),(()=>{var p=js(),d=p.firstChild;return x(d,A(I,{get when(){return!s()},get children(){return A(Ze,{accept:".tstprj",setFile:e,children:".tstprjファイルをドラッグ＆ドロップ"})}}),null),x(d,A(I,{get when(){return E(()=>!!s())()&&t()},get children(){var m=_t(),v=m.firstChild,_=v.nextSibling;return v.$$click=h,x(v,A(et,{get class(){return W.clearIcon}})),x(_,()=>t().name),k(b=>{var y=W.fileBox,w=W.iconButton,O=W.fileName;return y!==b.e&&P(m,b.e=y),w!==b.t&&P(v,b.t=w),O!==b.a&&P(_,b.a=O),b},{e:void 0,t:void 0,a:void 0}),m}}),null),x(d,A(I,{get when(){return!n()},get children(){return A(Ze,{accept:".ccs",setFile:r,children:".ccsファイルをドラッグ＆ドロップ"})}}),null),x(d,A(I,{get when(){return E(()=>!!o())()&&n()},get children(){var m=_t(),v=m.firstChild,_=v.nextSibling;return v.$$click=g,x(v,A(et,{get class(){return W.clearIcon}})),x(_,()=>n().name),k(b=>{var y=W.fileBox,w=W.iconButton,O=W.fileName;return y!==b.e&&P(m,b.e=y),w!==b.t&&P(v,b.t=w),O!==b.a&&P(_,b.a=O),b},{e:void 0,t:void 0,a:void 0}),m}}),null),x(p,A(I,{get when(){return E(()=>!!a())()&&u()},get children(){return A(xs,{get filename(){return t().name},get tstprj(){return s()},get ccs(){return o()}})}}),null),k(()=>P(d,W.fileContainer)),p})()};ee(["click"]);const Ts=document.getElementById("root"),Bs=()=>A(lr,{get children(){return[A(yt,{path:"/",component:Os}),A(yt,{path:"/editor",component:hs})]}});En(()=>A(Bs,{}),Ts);
